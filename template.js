const ships = [];

var Waifu_101 = '{"name":"Waifu","level":1,"model":1,"size":2.5,"specs":{"shield":{"capacity":[100,100],"reload":[5,5]},"generator":{"capacity":[10,10],"reload":[20,20]},"ship":{"mass":250,"speed":[120,120],"rotation":[50,50],"acceleration":[110,110]}},"bodies":{"leg1":{"section_segments":90,"offset":{"x":0,"y":20,"z":0},"position":{"x":[8,8,7.8,7.8,7.7,7.6,7.3,7.2,7.1,6.9,7,7.9,9.2,9.3,9.4,9.1,8.7,8.7],"y":[-40,-39.5,-39,-36,-30,-26,-15,-14,-12,-3,12,27,48,50,52,55,56.2,56.5],"z":[0,0,0,0.1,0.5,1.1,3.2,3.5,3.9,6.1,10,7.1,3.1,2.8,4,9.5,12.2,12]},"width":[0,4,5,6.3,6.6,6.5,6,5.9,5.7,4.6,3.6,3.6,2.2,2,2.2,2.5,1.7,1],"height":[0,6,7,8,8.9,9,8.4,8.3,8.2,7.2,4,4.4,3,2.8,3.5,2.5,1,0],"texture":[6,6,6,6,6,6,4,17,4,4,4,4,17,4]},"leg2":{"section_segments":90,"offset":{"x":0,"y":20,"z":0},"position":{"x":[-6,-6,-6.3,-7.4,-9.4,-10.4,-13.3,-13.6,-14.1,-17,-22,-24.9,-30.2,-30.7,-31.8,-35.7,-36.7,-36.7],"y":[-40,-39.5,-39,-36,-30,-26,-15,-14,-12,-3,12,27,48,50,52,55,56.2,56.5],"z":[0,0,0,0.1,0.5,1.1,3.2,3.5,3.9,6.1,10,7.1,3.1,2.8,4,8.5,10.5,10]},"width":[0,4,5,6.3,6.6,6.5,6,5.9,5.7,4.6,3.6,3.6,2.2,2,2.3,2.5,1.5,1],"height":[0,6,7,8,8.9,9,8.4,8.3,8.2,7.2,4,4.4,3,2.8,3.4,2.5,1,0],"texture":[6,6,6,6,6,6,4,17,4,4,4,4,17,4]},"waist":{"angle":180,"section_segments":16,"offset":{"x":0,"y":-15,"z":0},"position":{"x":[0,0,0,0,0,0,0,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1,-0.1],"y":[0.4,0.5,1,2,4,6,10,12,16,22,26,30,32,34,36,39,40.3,41.3,42,43,44,45,45.5,50,50],"z":[0,0,0,0,0.2,0.5,0,0.7,1.4,2.9,2.7,1.8,1.3,0.6,0.1,-1.1,-1.7,-2.5,-3.2,-4.6,-5.1,-5.1,-5.1,-5.1,-5.1]},"width":[0,1,5,7,12.5,12.6,12.7,11.6,10.5,10,10.2,10.9,11.4,12.2,12.8,12.9,12.3,11.6,10,5,3,2.5,2.4,2.4,0],"height":[2,5,6,7,9,9,11,10,9.2,8.1,8.3,9,9.2,9.5,9.3,8.8,8.2,7.1,6.1,4.5,2.6,2.1,2,2,0],"texture":[63,63,63,63,63,63,16,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,17,4,6]},"skirt":{"section_segments":16,"offset":{"x":0,"y":20,"z":0},"position":{"x":[0,0,-2,-2.3,-2,0,0],"y":[-45,-45,-25,-22,-25,-45,-45],"z":[0,0,2,2,2,0,0]},"width":[0,13,20,21.5,20,13,0],"height":[0,11,15,15.5,15,11,0],"texture":[4,4,17,5,17,5]},"skirt2":{"section_segments":15,"offset":{"x":0,"y":20,"z":0},"position":{"x":[0,0,-2,-2.3,-2,0,0],"y":[-45,-45,-25,-22,-25,-45,-45],"z":[0,0,2,2,2,0,0]},"width":[0,13,20,21.5,20,13,0],"height":[0,11.02,15.02,15.5,15,11,0],"texture":[4,3,17,5,17,5]},"tie":{"section_segments":[40,45,50,130,135,140,220,225,230,310,315,320],"offset":{"x":0,"y":0,"z":0},"position":{"x":[0,0,0,0,0,0,0,0,0,0],"y":[-58,-58,-57,-56,-55,-50,-45,-40,-35,-33],"z":[-1,0,4,6,8,11,12,12.4,13,13.4]},"width":[0,3,1.4,1.4,1.5,2,2.4,2.8,3.1,0],"height":[0,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0.1,0],"texture":[63,63,18,63]},"tieclip":{"section_segments":[40,45,50,130,135,140,220,225,230,310,315,320],"offset":{"x":0,"y":-43,"z":12},"position":{"x":[1,1,1,1],"y":[-0.5,-0.5,0,0],"z":[0,0,0,0]},"width":[0,2,2,0],"height":[0,0.5,0.5,0],"texture":[4]},"pocket":{"vertical":true,"angle":15,"section_segments":[40,45,50,130,135,140,220,225,230,310,315,320],"offset":{"x":0,"y":9.5,"z":53},"position":{"x":[6,6,6,6],"y":[-1,-1,0,0],"z":[0,0,0,0]},"width":[0,3.5,3.5,0],"height":[0,0.5,1,0],"texture":[4]},"main":{"section_segments":12,"offset":{"x":0,"y":-30,"z":11.6},"position":{"x":[0,0,0,0,0,0,0,0,0,0],"y":[-3.9,-3.5999999999999996,-3,-1.2,0.6,1.7999999999999998,3.3,4.5,3.5999999999999996],"z":[0,0,0,0,0,0,0,0,0]},"width":[0,0.48,0.6,1.7999999999999998,1.5,1.7999999999999998,1.08,0.8999999999999999,0],"height":[0,0.36,0.48,0.72,1.2,1.2,1.08,0.8999999999999999,0],"texture":[4,63,10,1,1,1,12,17]},"cockpit":{"section_segments":12,"offset":{"x":0,"y":-30,"z":12.2},"position":{"x":[0,0,0,0,0,0,0],"y":[-0.8999999999999999,0,1.2,1.7999999999999998,3.5999999999999996],"z":[0,0,0,0,0]},"width":[0,0.78,1.02,0.6,0.3],"height":[0,1.08,1.5,1.08,0.3],"propeller":false,"texture":[7,9,9,4,4]},"cannon":{"section_segments":6,"offset":{"x":0,"y":-30.9,"z":10.4},"position":{"x":[0,0,0,0,0,0],"y":[-2.4,-3,-1.2,0,1.2,1.7999999999999998],"z":[0,0,0,0,0,1.2]},"width":[0,0.3,0.48,0.6599999999999999,0.42,0],"height":[0,0.3,0.48,0.6599999999999999,0.6,0],"angle":0,"laser":{"damage":[5,5],"rate":4,"type":1,"speed":[160,160],"number":1,"error":2.5},"propeller":false,"texture":[3,3,10,3]},"l_arm":{"angle":70,"section_segments":90,"offset":{"x":0,"y":-65.7,"z":-3},"position":{"x":[-6,-6.1,-6.7,-6.6,-6.4,-6.6,-6.6,-6.6,-6.6,-6.6,-6.6,-6.6],"y":[9,10.5,12,14,16,22,30,31,33,42,42.5,42.6],"z":[-0.2,-0.4,-0.4,-0.4,-0.6,-1.2,-1.9,-2,-2.1,-2.8,-2.9,-2.9]},"width":[0,1.8,2.9,3,2.9,2.8,2.25,2.2,2.05,1.4,1,0],"height":[2,2.6,3.5,3.75,3.4,3,2.6,2.5,2.3,1.9,1.2,0],"texture":[6,6,6,6,6,6,4,17,4,4,4,4,17,4]},"l_sleeve":{"angle":-70,"section_segments":90,"offset":{"x":0,"y":-66.7,"z":-6},"position":{"x":[32,33,33,33,33,33],"y":[-28.7,-28.3,-27,-5,-3,-28,-15],"z":[-0.9,0.2,0.4,11.1,12.1,0.4]},"width":[0,1.1,1.6,4.8,4.9,1.1],"height":[0,1.9,2.1,3.8,3.9,1.1],"texture":[4,4,4,17,17,6]},"l_handbase":{"angle":-70,"section_segments":90,"offset":{"x":0,"y":-66.7,"z":-6},"position":{"x":[32,33,33,32.9,32.8,33,33],"y":[-20,-4,-2.5,-1.5,-0.2,1,1],"z":[3.4,13.2,13.9,14.2,14.6,14.8,14.8]},"width":[1,1.9,2.3,2.4,2.7,2.5,0],"height":[1,1.2,1.3,1.3,1.2,1.1,0],"texture":[6]},"l_thumb":{"angle":-70,"section_segments":90,"offset":{"x":0,"y":-65.2,"z":-3.7},"position":{"x":[29.2,28.8,29.3,29.3],"y":[-0.8,0.9,2.3,2.7],"z":[12.3,12,12.1,12.1]},"width":[0.5,0.4,0.3,0],"height":[0.7,0.6,0.4,0.2],"texture":[6]},"l_finger1":{"angle":-70,"section_segments":90,"offset":{"x":0,"y":-65.5,"z":-4.1},"position":{"x":[30.1,29.47,29.2,28.9,28.9],"y":[0.6,2.8,3.9,5.1,5.1],"z":[12.8,14.4,14.8,14.9,14.85]},"width":[0.7,0.5,0.4,0.3,0.15],"height":[0.8,0.5,0.3,0.2,0],"texture":[6]},"l_finger2":{"angle":-70,"section_segments":90,"offset":{"x":0,"y":-65.3,"z":-3.9},"position":{"x":[30.9,30.8,30.7,30.6,30.6],"y":[0.5,2.5,4,5.6,5.7],"z":[12.8,14.4,15.2,15.1,15.05]},"width":[0.9,0.5,0.4,0.3,0.15],"height":[0.9,0.5,0.3,0.2,0],"texture":[6]},"l_finger3":{"angle":-70,"section_segments":90,"offset":{"x":0,"y":-65.1,"z":-4},"position":{"x":[31.8,32.1,32.2,32.2,32.2],"y":[0.4,2.3,3.7,5.2,5.3],"z":[13,14.5,15.1,15.1,15.05]},"width":[0.8,0.5,0.4,0.3,0.15],"height":[0.9,0.5,0.3,0.2,0],"texture":[6]},"l_finger4":{"angle":-70,"section_segments":90,"offset":{"x":0,"y":-64.7,"z":-4.2},"position":{"x":[32.8,33.1,33.2,33.2,33.2],"y":[0.3,2.2,3.3,4.4,4.5],"z":[12.9,14.5,15.1,15.1,15.05]},"width":[0.8,0.4,0.35,0.3,0.15],"height":[0.9,0.5,0.3,0.2,0],"texture":[6]},"r_arm":{"angle":-110,"section_segments":90,"offset":{"x":0,"y":-58.4,"z":-3},"position":{"x":[6,6.1,6.7,6.6,6.4,6.6,6.6,6.6,6.6,6.6,6.6,6.6],"y":[5,6.5,8,10,12,18,26,27,29,38,38.5,38.6],"z":[0.2,0.4,0.4,0.4,0.6,1.2,1.9,2,2.1,2.8,2.9,2.9]},"width":[0,1.8,2.9,3,2.9,2.8,2.25,2.2,2.05,1.4,1,0],"height":[2,2.6,3.5,3.75,3.4,3,2.6,2.5,2.3,1.9,1.2,0],"texture":[6,6,6,6,6,6,4,17,4,4,4,4,17,4]},"r_sleeve":{"angle":110,"section_segments":90,"offset":{"x":0,"y":-43.7,"z":0},"position":{"x":[32,33,33,33,33,33],"y":[-28.7,-28.3,-27,-5,-3,-28,-15],"z":[-0.9,0.2,0.4,11.1,12.1,0.4]},"width":[0,1.1,1.6,4.8,4.9,1.1],"height":[0,1.9,2.1,3.8,3.9,1.1],"texture":[4,4,4,17,17,6]},"r_handbase":{"angle":110,"section_segments":90,"offset":{"x":0,"y":-43.7,"z":0},"position":{"x":[32,33,33,32.9,32.8,33,33],"y":[-20,-4,-2.5,-1.5,-0.2,1,1],"z":[3.4,13.1,13.7,13.9,14.1,14.7,14.7]},"width":[1,1.9,2.3,2.4,2.7,2.5,0],"height":[1,1.2,1.3,1.3,1.2,1.1,0],"texture":[6]},"r_thumb":{"angle":110,"section_segments":90,"offset":{"x":0,"y":-45.2,"z":2.2},"position":{"x":[30.5,29.4,30.2,30.6,29.5],"y":[-1.3,-0.2,0.3,0.7,0.8],"z":[12,13.2,13.7,13.9,14.1]},"width":[1.5,0.7,1.5,1.2,0],"height":[1,0.6,0.6,0.6,0.4],"texture":[6]},"r_finger1":{"angle":110,"section_segments":90,"offset":{"x":0,"y":-44.5,"z":1.9},"position":{"x":[30.1,29.47,29.2,28.9,28.9],"y":[0.6,3.2,4.3,6.1,6.2],"z":[12.8,13,13.1,13.9,13.95]},"width":[0.7,0.5,0.4,0.3,0.15],"height":[0.8,0.5,0.4,0.25,0],"texture":[6]},"r_finger2":{"angle":110,"section_segments":90,"offset":{"x":0,"y":-45.1,"z":2.1},"position":{"x":[30.9,30.8,30.7,30.6,30.6],"y":[0.5,3.3,4.5,6.6,6.7],"z":[12.8,13,13.1,13.9,13.95]},"width":[0.9,0.5,0.4,0.3,0.15],"height":[0.9,0.5,0.3,0.2,0],"texture":[6]},"r_finger3a":{"angle":110,"section_segments":90,"offset":{"x":0,"y":-46.8,"z":2},"position":{"x":[30.9,30.8,30.7,30.6],"y":[-0.1,0.4,1,1.2],"z":[12.8,13.8,13.8,12.5]},"width":[0.9,0.5,0.4,0.1],"height":[1.1,2,1.6,0],"texture":[6]},"r_finger3b":{"angle":110,"section_segments":90,"offset":{"x":0,"y":-46.8,"z":1.8},"position":{"x":[30.9,30.8,30.7,30.6,30.6],"y":[-3.1,-3,-1.9,0.4,0.4],"z":[14.2,14.1,14.9,15.5,15.5]},"width":[0.15,0.3,0.4,0.5],"height":[0,0.2,0.3,0.5],"texture":[6]},"r_finger4a":{"angle":110,"section_segments":90,"offset":{"x":0,"y":-48,"z":2},"position":{"x":[30.9,30.8,30.7,30.6],"y":[-0.3,0.2,0.6,0.8],"z":[12.8,13.8,13.8,12.5]},"width":[0.9,0.5,0.4,0.1],"height":[1,1.8,1.6,0],"texture":[6]},"r_finger4b":{"angle":110,"section_segments":90,"offset":{"x":0,"y":-48,"z":1.8},"position":{"x":[30.9,30.8,30.7,30.6,30.6],"y":[-2.6,-2.4,-1.6,0.2,0.2],"z":[13.8,14,14.6,15.3,15.2]},"width":[0.15,0.3,0.4,0.5,0],"height":[0,0.2,0.3,0.5,0],"texture":[6]},"head":{"angle":180,"section_segments":70,"offset":{"x":0,"y":-61.1,"z":-5.2},"position":{"x":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],"y":[0,0.13,0.26,0.39,0.52,0.65,0.78,1.1700000000000002,1.9500000000000002,2.6,3.12,3.9000000000000004,4.42,5.2,5.8500000000000005,6.5,7.800000000000001,10.4,13,14.3,15.600000000000001,16.900000000000002,18.2,19.5,20.8,22.1,23.400000000000002,24.57,24.96,25.090000000000003,25.22],"z":[7.15,7.345000000000001,7.085000000000001,6.786,6.5,6.370000000000001,6.24,5.8500000000000005,5.07,4.511,4.16,2.4050000000000002,1.8199999999999998,1.1700000000000002,0.8450000000000001,0.52,0.13,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},"width":[0,0.52,0.9750000000000001,1.6900000000000002,2.21,2.6,2.9899999999999998,3.77,4.9399999999999995,5.8500000000000005,6.370000000000001,7.279999999999999,7.670000000000001,8.125,8.450000000000001,8.71,9.165000000000001,9.879999999999999,10.4,10.621,10.673000000000002,10.699000000000002,10.439,10.01,9.321,8.385,7.0200000000000005,5.044,4.16,3.25,0],"height":[0,1.04,1.4949999999999999,1.8199999999999998,2.197,2.4050000000000002,2.6,3.12,4.03,4.745,5.2,7.15,7.800000000000001,8.58,8.97,9.360000000000001,10.01,10.53,11.05,11.154,11.05,10.920000000000002,10.4,9.879999999999999,8.866000000000001,7.891000000000001,6.123,3.8870000000000005,2.6,1.3,0],"texture":[6]},"eyelash1":{"angle":95,"section_segments":60,"offset":{"x":7.41,"y":-72.748,"z":5.07},"position":{"x":[-0.9099999999999999,-0.26,0.195,0.312,0.4784000000000001,0.624,0.6656000000000001,0.624,0.52,0.4368,0.24960000000000002,0.20800000000000005,-0.624],"y":[-5.5120000000000005,-5.304,-5.096000000000001,-4.992,-4.784,-3.9520000000000004,-3.5360000000000005,-2.704,-1.8720000000000003,-1.456,-0.8320000000000002,-0.624,-0.20800000000000005],"z":[0,-0.013000000000000001,0,0,0,-0.13,-0.39,-0.9099999999999999,-1.3,-1.4300000000000002,-1.9500000000000002,-2.21,-3.3800000000000003,-2.21,-2.6]},"width":[0,0.4160000000000001,0.4160000000000001,0.4160000000000001,0.29120000000000007,0.27040000000000003,0.24960000000000002,0.24960000000000002,0.20800000000000005,0.20800000000000005,0.20800000000000005,0.20800000000000005,0],"height":[0,0.65,0.65,0.65,0.65,0.65,0.65,0.65,0.65,0.65,0.65,0.65,0.65,0],"texture":[5]},"eyelash2":{"angle":95,"section_segments":60,"offset":{"x":7.41,"y":-72.748,"z":5.07},"position":{"x":[-0.9099999999999999,-0.26,0.195,0.312,0.4784000000000001,0.624,0.6656000000000001,0.624,0.52,0.4368,0.24960000000000002,0.20800000000000005,0.624],"y":[-5.5120000000000005,-5.304,-5.096000000000001,-4.992,-4.784,-3.9520000000000004,-3.5360000000000005,-2.704,-1.8720000000000003,-1.456,-0.8320000000000002,-0.624,0.20800000000000005],"z":[0,-0.013000000000000001,0,0,0,-0.13,-0.39,-0.9099999999999999,-1.3,-1.4300000000000002,-1.9500000000000002,-2.21,-3.3800000000000003,-2.21,-2.3400000000000003]},"width":[0,0.4160000000000001,0.4160000000000001,0.4160000000000001,0.29120000000000007,0.27040000000000003,0.24960000000000002,0.24960000000000002,0.20800000000000005,0.20800000000000005,0.20800000000000005,0.20800000000000005,0],"height":[0,0.65,0.65,0.65,0.65,0.65,0.65,0.65,0.65,0.65,0.65,0.65,0.65,0],"texture":[5]},"eyebrows":{"angle":89,"section_segments":60,"offset":{"x":7.279999999999999,"y":-74.49,"z":5.07},"position":{"x":[-0.9099999999999999,0,0.195,0.312,0.52,0.624,0.6656000000000001,0.624,0.4784000000000001,0.312,0.27040000000000003,-0.11699999999999999,-0.4160000000000001],"y":[-5.5120000000000005,-5.304,-5.2,-4.992,-4.5760000000000005,-3.7440000000000007,-3.1200000000000006,-2.08,-0.8320000000000002,0,0.4160000000000001],"z":[0,-0.013000000000000001,0,0,0,-0.13,-0.39,-0.9099999999999999,-1.8199999999999998,-2.7300000000000004,-3.25,-3.9000000000000004,-4.42]},"width":[0,0.4160000000000001,0.4160000000000001,0.4160000000000001,0.312,0.22880000000000003,0.20800000000000005,0.16640000000000002,0.08320000000000001,0.10400000000000002,0],"height":[0,0.65,0.65,0.65,0.65,0.65,0.65,0.65,0.65,0.65,0.65,0.65,0.65,0],"texture":[5]},"iris":{"angle":205,"vertical":true,"section_segments":50,"offset":{"x":4.03,"y":4.940000000000001,"z":71.24},"position":{"x":[0,0,0,0,0,0.52,0.754,0.78,0,0,-0.52,-0.78,-1.1700000000000002,-1.56,-1.6900000000000002,-3.12,-1.612],"y":[0,0,0,0,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.026000000000000002,0.026000000000000002,0.026000000000000002,0.026000000000000002,0.026000000000000002,0.026000000000000002],"z":[0.26,0.065,0,0,0,0,0,-0.26,0,0,0,0.09100000000000001,0.26,0.65,0.65,1.56,0]},"width":[0,0.676,1.1700000000000002,1.3,1.3,1.3,1.3,1.1700000000000002,0,1.3,1.3,1.3,1.3,0.78,0.9099999999999999,0,0.9099999999999999,0.9099999999999999,0.9099999999999999],"height":[0,0.78,1.4300000000000002,1.56,1.625,1.573,1.534,1.3,0,1.625,1.625,1.573,1.4300000000000002,0.9099999999999999,1.04,0,1.04,1.04],"texture":[5,63,5,100,100,100,100,100,100,100,100,100,5]},"white1":{"vertical":true,"angle":205,"section_segments":50,"offset":{"x":0,"y":6.8900000000000015,"z":72.02},"position":{"x":[-4.680000000000001,-4.9399999999999995],"y":[0,0],"z":[0,0]},"width":[0,0.325],"height":[0,0.325],"texture":[100]},"white2":{"vertical":true,"angle":205,"section_segments":50,"offset":{"x":0,"y":6.8900000000000015,"z":70.72},"position":{"x":[-4.55,-4.42],"y":[0,0],"z":[0,0]},"width":[0,0.23399999999999999],"height":[0,0.195],"propeller":false,"texture":[100]},"white3":{"vertical":true,"angle":155,"section_segments":50,"offset":{"x":0,"y":6.8900000000000015,"z":72.02},"position":{"x":[3.965,3.965],"y":[0,0],"z":[0,0]},"width":[0,0.325],"height":[0,0.325],"texture":[100]},"white4":{"vertical":true,"angle":155,"section_segments":50,"offset":{"x":0,"y":6.8900000000000015,"z":70.72},"position":{"x":[4.537000000000001,4.537000000000001],"y":[0,0],"z":[0,0]},"width":[0,0.23399999999999999],"height":[0,0.195],"propeller":false,"texture":[100]},"speck":{"vertical":true,"angle":150,"section_segments":4,"offset":{"x":0.013000000000000001,"y":-53.82,"z":-3.9000000000000004},"position":{"x":[4.537000000000001,4.537000000000001],"y":[0,0],"z":[0,0]},"width":[0,0.13],"height":[0,0.13],"propeller":false,"texture":[100]},"noseline":{"angle":180,"section_segments":60,"offset":{"x":0,"y":-72.748,"z":5.07},"position":{"x":[-0.26,-1.04,-0.26],"y":[-4.16,-3.7440000000000007,-2.08],"z":[0,1.3,0]},"width":[0,0.13,0],"height":[0,0.13,0],"texture":[5]},"mouth":{"angle":90,"section_segments":12,"offset":{"x":0,"y":-65,"z":4.55},"position":{"x":[1.3,0.78,0.5850000000000001,0.39,0.23399999999999999,0.156,0.078,0.078,0.078,0.156,0.22100000000000003,0.325,0.52,0.676,1.131],"y":[-2.6,-2.21,-1.9500000000000002,-1.56,-1.1700000000000002,-0.78,-0.39,0,0.39,0.78,1.1700000000000002,1.56,1.9500000000000002,2.21,2.6],"z":[-0.45499999999999996,-0.35100000000000003,-0.28600000000000003,-0.20800000000000002,-0.13,-0.078,-0.065,-0.052000000000000005,-0.065,-0.078,-0.14300000000000002,-0.20800000000000002,-0.29900000000000004,-0.36400000000000005,-0.45499999999999996]},"width":[0,0.39,0.52,0.65,0.78,0.8450000000000001,0.9099999999999999,0.9099999999999999,0.9099999999999999,0.8450000000000001,0.767,0.676,0.52,0.39,0],"height":[0,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0],"texture":[5]},"lowerlip":{"angle":90,"section_segments":12,"offset":{"x":0,"y":-64.48,"z":4.563},"position":{"x":[1.8199999999999998,1.014,0.637,0.377,0.18200000000000002,0.065,0,-0.013000000000000001,0,0.078,0.169,0.35100000000000003,0.65,0.9359999999999999,1.625],"y":[-2.6,-2.21,-1.9500000000000002,-1.56,-1.1700000000000002,-0.78,-0.39,0,0.39,0.78,1.1700000000000002,1.56,1.9500000000000002,2.21,2.6],"z":[-0.45499999999999996,-0.35100000000000003,-0.28600000000000003,-0.20800000000000002,-0.13,-0.078,-0.065,-0.052000000000000005,-0.065,-0.078,-0.14300000000000002,-0.20800000000000002,-0.29900000000000004,-0.36400000000000005,-0.45499999999999996]},"width":[0,0.195,0.18200000000000002,0.195,0.26,0.29250000000000004,0.325,0.2977,0.325,0.29250000000000004,0.26,0.195,0.13,0.13,0],"height":[0,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0],"texture":[30]},"teeth":{"angle":90,"section_segments":12,"offset":{"x":0,"y":-64.805,"z":4.563},"position":{"x":[1.3650000000000002,1.157,1.0010000000000001,0.9359999999999999,0.9099999999999999,0.8969999999999999,0.8905000000000001,0.8905000000000001,0.8905000000000001,0.8969999999999999,0.9099999999999999,0.9229999999999999,0.9750000000000001,1.0530000000000002,1.1960000000000002],"y":[-2.3400000000000003,-2.08,-1.6900000000000002,-1.04,-0.78,-0.52,-0.26,0,0.26,0.52,0.78,1.04,1.6900000000000002,2.08,2.3400000000000003],"z":[-0.39,-0.325,-0.22100000000000003,-0.10400000000000001,-0.065,-0.039,-0.026000000000000002,-0.026000000000000002,-0.039,-0.052000000000000005,-0.078,-0.10400000000000001,-0.22100000000000003,-0.338,-0.39]},"width":[0,0.09100000000000001,0.169,0.195,0.20800000000000002,0.21450000000000002,0.22100000000000003,0.22100000000000003,0.22100000000000003,0.21450000000000002,0.20800000000000002,0.195,0.156,0.10400000000000001,0],"height":[0,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0.013000000000000001,0],"texture":[100]},"hair1":{"vertical":true,"angle":184,"section_segments":12,"offset":{"x":0,"y":-4.5,"z":81.60000000000001},"position":{"x":[-2,-0.8,0,0,0,0],"y":[-11,-9.5,-6,-3,-1,0],"z":[-3,-0.3,3,4.1,4.8,5]},"width":[0,0.3,0.6,0.7,0.6,0],"height":[0,0.2,0.3,0.4,0.3,0],"texture":[63]},"hair2":{"vertical":true,"angle":171,"section_segments":12,"offset":{"x":0,"y":-4.5,"z":81.60000000000001},"position":{"x":[3.8,1.2,0.4,0,0,0,0,0,0],"y":[-12,-11.5,-11,-10,-9,-7,-4,-1,0],"z":[-6,-3.3,-2,-0.1,1.4,3,4.3,5,5.1]},"width":[0,1.3,1.5,1.6,1.65,1.5,1.1,0.3,0],"height":[0,0.2,0.3,0.4,0.3,0.3,0.3,0.2,0],"texture":[63]},"hair3":{"vertical":true,"angle":205,"section_segments":12,"offset":{"x":0,"y":-4.5,"z":81.60000000000001},"position":{"x":[-5,-2.9,-2,-1.1,-0.5,0,0,0,0],"y":[-12,-11.5,-11,-10,-9,-7,-4,-1,0],"z":[-7,-3.7,-2,-0.1,1.4,3,4.3,5,5.1]},"width":[0,1.15,1.4,1.5,1.6,1.4,1,0.4,0],"height":[0,0.2,1.3,1.4,1.3,0.8,0.5,0.2,0],"texture":[63]},"hair4":{"vertical":true,"angle":190,"section_segments":12,"offset":{"x":0,"y":-4.4,"z":81.60000000000001},"position":{"x":[-5,-2.9,-2,-1.1,-0.5,0,0,0,0],"y":[-12,-11.5,-11,-10,-9,-7,-4,-1,0],"z":[-7,-3.7,-2,-0.1,1.4,3,4.3,5,5.1]},"width":[0,0.8,1,1.2,1.3,1.2,1,0.4,0],"height":[0,0.2,0.3,0.4,0.3,0.3,0.3,0.2,0],"texture":[63]},"hair5":{"vertical":true,"angle":160,"section_segments":12,"offset":{"x":0,"y":-4.5,"z":81.60000000000001},"position":{"x":[5,2.9,2,1.1,0.5,0,0,0,0],"y":[-12,-11.5,-11,-10,-9,-7,-4,-1,0],"z":[-7,-3.7,-2,-0.1,1.4,3,4.3,5,5.1]},"width":[0,1.15,1.4,1.5,1.6,1.4,1,0.4,0],"height":[0,0.9,1.3,1.4,0.9,0.6,0.4,0.2,0],"texture":[63]},"hair6":{"vertical":true,"angle":166.5,"section_segments":12,"offset":{"x":0,"y":-4.5,"z":81.60000000000001},"position":{"x":[2,0.8,0,0,0,0],"y":[-11,-9.5,-6,-3,-1,0],"z":[-3,-0.3,3,4.1,4.8,5]},"width":[0,0.3,0.6,0.7,0.6,0],"height":[0,0.2,0.3,0.4,0.3,0],"texture":[63]},"hair7":{"vertical":true,"angle":190,"section_segments":12,"offset":{"x":0,"y":-4.5,"z":81.60000000000001},"position":{"x":[-1.7,-0.5,-0.2,0,0,0,0,0,0],"y":[-12,-11.5,-11,-10,-9,-7,-4,-1,0],"z":[-10,-4.5,-2,-0.1,1.4,3,4.3,5,5.1]},"width":[0,1.2,1.4,1.6,1.65,1.5,1.1,0.3,0],"height":[0,2,1.1,1.2,1,0.7,0.5,0.2,0],"texture":[63]},"hair8":{"vertical":true,"angle":152,"section_segments":12,"offset":{"x":0,"y":-4.4,"z":81.60000000000001},"position":{"x":[5,2.9,2,1.1,0.5,0,0,0,0],"y":[-12,-11.5,-11,-10,-9,-7,-4,-1,0],"z":[-7,-3.7,-2,-0.1,1.4,3,4.3,5,5.1]},"width":[0,0.4,0.5,0.6,0.65,0.6,0.5,0.2,0],"height":[0,0.4,0.8,1.2,1.1,0.8,0.5,0.2,0],"texture":[63]},"hair9":{"vertical":true,"angle":225,"section_segments":12,"offset":{"x":0,"y":-4.5,"z":81.60000000000001},"position":{"x":[-4,-2.5,-1.5,-1.4,-1.3,-1.2,-1,-0.4,0],"y":[-12,-11.5,-11,-10,-9,-7,-4,-1,0],"z":[-14,-8.3,-4,-0.4,1.2,3,4.3,5,5.1]},"width":[0,1.6,2.5,2.6,2.65,2.5,2.1,1.3,0],"height":[0,2.2,2.3,1.6,1.3,0.8,0.6,0.2,0],"texture":[63]},"hair10":{"vertical":true,"angle":135,"section_segments":12,"offset":{"x":0,"y":-4.5,"z":81.60000000000001},"position":{"x":[1.8,0.5,0.3,0,0,0,0,0,0],"y":[-12,-11.5,-11,-10,-9,-7,-4,-1,0],"z":[-8,-3.3,-2,-0.1,1.4,3,4.3,5,5.1]},"width":[0,1.9,2.2,2.6,2.65,2.5,2.1,1.3,0],"height":[0,0.5,0.9,1.2,1.3,1.3,0.8,0.2,0],"texture":[31]},"hair11":{"vertical":true,"angle":245,"section_segments":12,"offset":{"x":0,"y":-4.5,"z":81.60000000000001},"position":{"x":[-0.7,-0.3,-0.1,0,0,0,0,0,0],"y":[-12,-11.5,-11,-10,-9,-7,-4,-1,0],"z":[-10,-5.5,-2,-0.1,1.4,3,4.3,5,5.1]},"width":[0.1,0.4,0.6,0.7,0.85,0.9,1.1,0.3,0],"height":[0,0.3,0.3,0.4,0.4,0.3,0.3,0.2,0],"texture":[63]},"hair12":{"vertical":true,"angle":105,"section_segments":12,"offset":{"x":0,"y":-4.5,"z":82.60000000000001},"position":{"x":[-4,-2.5,-1.9,-1.5,-1.3,-1.2,-1,-0.4,0],"y":[-12,-11.5,-11,-10,-9,-7,-4,-1,0],"z":[-17,-8.3,-4,-1.4,0.2,2,3.3,4,4.1]},"width":[0.2,1.6,2.5,2.6,2.65,2.5,2.1,1.3,0],"height":[0,2.2,2.3,1.6,1.3,0.8,0.6,0.2,0],"texture":[63]},"hair13":{"vertical":true,"angle":253,"section_segments":12,"offset":{"x":0,"y":-4.5,"z":82.10000000000001},"position":{"x":[0,0,0,0,0,0,0,0,0],"y":[-12,-11.5,-11,-10,-9,-7,-4,-1,0],"z":[-20,-8.3,-4,-0.4,1.2,3,4.3,4.6,4.6]},"width":[0.1,0.6,1,1.1,1,0.9,0.8,0.6,0],"height":[0,2.2,2.3,1.6,1.3,0.8,0.6,0.2,0],"texture":[63]},"hair14":{"vertical":true,"angle":263,"section_segments":12,"offset":{"x":0,"y":-4.5,"z":82.10000000000001},"position":{"x":[0,0,0,0,0,0,0,0,0],"y":[-12,-11,-10.5,-9.5,-8.5,-6.5,-3.5,-1,0],"z":[-14,-8.3,-4,-0.4,1.2,3,4.3,4.6,4.6]},"width":[0,0.6,1,1.1,1,0.9,0.8,0.6,0],"height":[0,2.2,2.3,1.6,1.3,0.8,0.6,0.2,0],"texture":[63]},"hair15":{"vertical":true,"angle":100,"section_segments":12,"offset":{"x":0,"y":-4.5,"z":81.60000000000001},"position":{"x":[0,0,0,0,0,0,0,0,0],"y":[-12,-11.5,-11,-10,-9,-7,-4,-1,0],"z":[-8,-4.5,-2,-0.1,1.4,3,4.3,5,5.1]},"width":[0,1.2,1.4,1.6,1.65,1.5,1.1,0.3,0],"height":[0,2,1.1,1.2,1,0.7,0.5,0.2,0],"texture":[63]},"hair16":{"vertical":true,"angle":85,"section_segments":12,"offset":{"x":0,"y":-4.5,"z":82.10000000000001},"position":{"x":[-2,-1.1,-0.9,-0.5,-0.3,-0.2,0,0,0],"y":[-11.5,-11.3,-11,-10,-9,-8,-5,-3,-1],"z":[-19,-10.3,-6,-1.4,0.2,2,3.3,4,4.1]},"width":[0.2,1.6,2.5,2.6,2.65,2.5,2.1,1.3,0],"height":[0,2.2,2.3,1.6,1.3,0.8,0.6,0.2,0],"texture":[63]},"hair17":{"vertical":true,"angle":99,"section_segments":12,"offset":{"x":0,"y":-4.5,"z":81.60000000000001},"position":{"x":[0,0,0,0,0,0,0,0,0],"y":[-11.5,-11,-10.5,-9.5,-8.5,-6.5,-3.5,-1,0],"z":[-14,-8.3,-4,-0.4,1.2,3,4.3,4.6,4.6]},"width":[0,0.6,1,1.1,1,0.9,0.8,0.6,0],"height":[0,2.2,2.3,1.6,1.3,0.8,0.6,0.2,0],"texture":[63]},"hair18":{"vertical":true,"angle":265,"section_segments":12,"offset":{"x":0,"y":-4.5,"z":80.60000000000001},"position":{"x":[-2,-1.5,-1.3,-1.2,-1.3,-1.2,-1,-0.4,0],"y":[-12,-11.5,-11,-10,-9,-7,-4,-1,0],"z":[-13,-8.3,-4,-0.4,1.2,3,4.3,5,5.1]},"width":[0,1.6,2.5,2.6,2.65,2.5,2.1,1.3,0],"height":[0,2.2,2.3,1.6,1.3,0.8,0.6,0.2,0],"texture":[63]},"hair19":{"vertical":true,"angle":185.5,"section_segments":12,"offset":{"x":0,"y":-4.5,"z":81.60000000000001},"position":{"x":[1.5,0.8,0,0,0,0],"y":[-11,-9.5,-6,-3,-1,0],"z":[-3,-0.3,3,4.1,4.8,5]},"width":[0.1,0.3,0.6,0.7,0.6,0],"height":[0,0.2,0.3,0.4,0.3,0],"texture":[63]},"rear_hair":{"angle":0,"section_segments":20,"offset":{"x":0,"y":-67.60000000000001,"z":-4.5},"position":{"x":[0,0,0,0,0,0,0,0,0,0,0],"y":[-19,-18.3,-17.5,-16,-13,-10,-6,-1,1,2.5],"z":[0,-1,-1.7,-2.7,-2.7,-2.4,-2.1,-1.9,-1.4,-0.9]},"width":[0,5.7,7,9,10.5,11.1,10.6,9,7.2,5.4],"height":[0,4,5,6.1,8,9.5,9.9,8.7,8,5],"texture":[63]},"scrungies":{"vertical":true,"angle":55,"section_segments":4,"offset":{"x":0.01,"y":-4.5,"z":80.60000000000001},"position":{"x":[0,0,0,0,0,0,0],"y":[-13,-13,-12,-11,-10,-10,-13],"z":[0,0,0,0,0,0,0]},"width":[3.5,4.5,4.5,4.5,4.5,3.5,3.5],"height":[3.5,4.5,4.5,4.5,4.5,3.5,3.5],"texture":[5,5,17,5]},"pigtails1":{"vertical":true,"angle":55,"section_segments":12,"offset":{"x":0.01,"y":-4.5,"z":75.60000000000001},"position":{"x":[0,0,0,0,0,0,0,0,0,0,0,0,0],"y":[-65,-60,-55,-50,-45,-40,-35,-30,-25,-20,-18,-15,-13,-12],"z":[-125,-118,-105,-90,-70,-50,-25,-5,3,8,8.4,8,5,5.9,5]},"width":[0,1.1,1.4,1.5,1.6,1.65,1.7,1.9,1.95,2,2,2.1,3],"height":[0,2.3,3.1,3.1,3.1,3.1,3.1,3.1,3.1,2.1,2.2,2.1,3],"texture":[63]},"pigtails2":{"vertical":true,"angle":56,"section_segments":12,"offset":{"x":0.01,"y":-4.5,"z":75.10000000000001},"position":{"x":[0,0,0,0,0,0,0,0,0,0,0,0,0],"y":[-65,-60,-55,-50,-45,-40,-35,-30,-25,-20,-18,-15,-13,-12],"z":[-95,-92,-85,-70,-50,-31,-12,-3,1,5,5.4,5.6,5,5,5]},"width":[0,1.1,1.4,1.5,1.6,1.65,1.7,1.9,1.95,2,2,2.1,3],"height":[0,1.3,2.8,3.1,3.1,3.1,3.1,3.1,3.1,2.1,2.2,2.1,3],"texture":[63]},"pigtails3":{"vertical":true,"angle":53,"section_segments":12,"offset":{"x":0.01,"y":-4.5,"z":75.10000000000001},"position":{"x":[0,0,0,0,0,0,0,0,0,0,0,0,0],"y":[-65,-60,-55,-50,-45,-40,-35,-30,-25,-20,-18,-15,-13,-12],"z":[-105,-102,-95,-80,-60,-41,-22,-8,1,5,5.4,5.6,5,5,5]},"width":[0,1.1,1.4,1.5,1.6,1.65,1.7,1.9,1.95,2,2,2.1,3],"height":[0,1.1,2.7,3.1,3.1,3.1,3.1,3.1,3.1,2.1,2.2,2.1,3],"texture":[63]},"pigtails4":{"vertical":true,"angle":55,"section_segments":12,"offset":{"x":0.01,"y":-4.5,"z":75.10000000000001},"position":{"x":[0,0,0,0,0,0,0,0,0,0,0,0,0],"y":[-65,-60,-55,-50,-45,-40,-35,-30,-25,-20,-18,-15,-13,-12],"z":[-115,-108,-95,-70,-50,-31,-12,-3,1,5,5.4,5.6,5,5,5]},"width":[0,0.1,0.4,0.5,0.6,0.65,0.7,0.9,0.95,1,1,1.1,1],"height":[0,1.3,2.1,3.1,3.1,3.1,3.1,3.1,3.1,2.1,2.2,2.1,3],"texture":[63]},"pigtails5":{"vertical":true,"angle":55,"section_segments":12,"offset":{"x":0.01,"y":-4.5,"z":75.60000000000001},"position":{"x":[-14,-12,-10,-8.5,-7,-6,-5,-4.5,-4,-3,-2,-1,0],"y":[-65,-60,-55,-50,-45,-40,-35,-30,-25,-20,-18,-15,-13,-12],"z":[-125,-118,-105,-90,-70,-50,-25,-7,3,8,8.4,8,5,5.9,5]},"width":[0,1.1,1.4,1.5,1.6,1.65,1.7,1.9,1.95,2,2,2.1,3],"height":[0,2.3,3.1,3.1,3.1,3.1,3.1,3.1,3.1,2.1,2.2,2.1,3],"texture":[63]},"pigtails6":{"vertical":true,"angle":60,"section_segments":12,"offset":{"x":0.01,"y":-4.5,"z":74.60000000000001},"position":{"x":[0,0,0,0,0,0,0,0,0,0,0,0,0],"y":[-65,-60,-55,-50,-45,-40,-35,-30,-25,-20,-18,-15,-13,-12],"z":[-65,-58,-48,-35,-19,-8,0,5,8,9,8.4,5.6,5,5,5]},"width":[0,0.1,0.4,0.5,0.6,0.65,0.7,0.9,0.95,1,1,1.1,1],"height":[0,1.3,2.1,3.1,2.1,2.1,1.7,1.1,1.1,1.1,1.2,2.1,3],"texture":[63]},"pigtails7":{"vertical":true,"angle":56,"section_segments":12,"offset":{"x":0.01,"y":-4.5,"z":75.10000000000001},"position":{"x":[-6,-5,-4,-3,-2,-1,-0.5,0,0,0,0,0,0],"y":[-65,-60,-55,-50,-45,-40,-35,-30,-25,-20,-18,-15,-13,-12],"z":[-86,-78,-69,-56,-37,-21,-7,0,3,5.5,5.4,5.6,5,5,5]},"width":[0,1.1,1.4,1.5,1.6,1.65,1.7,1.9,1.95,2,2,2.1,3],"height":[0,1.1,2.7,3.1,3.1,3.1,3.1,3.1,3.1,2.1,2.2,2.1,3],"texture":[63]},"pigtails8":{"vertical":true,"angle":55,"section_segments":12,"offset":{"x":0.01,"y":-4.5,"z":75.60000000000001},"position":{"x":[-24,-17,-12,-8.5,-7,-6,-5,-4.5,-4,-3,-2,-1,0],"y":[-63,-60,-55,-50,-45,-40,-35,-30,-25,-20,-18,-15,-13,-12],"z":[-129,-128,-123,-109,-90,-65,-40,-20,-5,3,4.4,5,5,4.9,5]},"width":[0,1.1,1.4,1.5,1.6,1.65,1.7,1.9,1.95,2,2,2.1,3],"height":[0,0.9,1.4,3.1,3.1,3.1,3.1,3.1,3.1,2.1,2.2,2.1,3],"texture":[63]},"pigtails9":{"vertical":true,"angle":55,"section_segments":12,"offset":{"x":0.01,"y":-4.5,"z":73.60000000000001},"position":{"x":[0,0,0,0,0,0,0,0,0,0,0,0,0],"y":[-61,-58,-55,-50,-45,-40,-35,-30,-25,-20,-18,-15,-13,-12],"z":[-72,-63,-53,-39,-24,-9,0,5,8,9,8.4,5.6,5,5,5]},"width":[0,0.1,0.4,0.5,0.6,0.65,0.7,0.9,0.95,1,1,1.1,1],"height":[0,1.3,2,2.1,2.1,2.1,1.7,1.1,1.1,1.1,1.2,2.1,3],"texture":[63]}},"wings":{"main":{"length":[3.5999999999999996,1.2],"width":[6,3,2.4],"angle":[-10,10],"position":[0,1.2,0.6],"doubleside":true,"offset":{"x":0,"y":-29.4,"z":11.3},"bump":{"position":30,"size":20},"texture":[11,63]}},"typespec":{"name":"Waifu","level":1,"model":1,"code":101,"specs":{"shield":{"capacity":[100,100],"reload":[5,5]},"generator":{"capacity":[10,10],"reload":[20,20]},"ship":{"mass":250,"speed":[120,120],"rotation":[50,50],"acceleration":[110,110]}},"shape":[4.354,4.383,4.381,4.236,3.919,3.552,3.236,3.002,2.85,2.764,2.79,2.855,2.598,2.788,2.913,2.872,2.958,3.508,4.22,3.587,1.062,1.297,1.722,3.045,3.856,0,0,0,4.227,4.264,2.598,3.587,4.22,3.508,2.958,2.872,2.913,2.788,2.6,2.855,2.79,2.764,2.85,3.001,3.236,3.552,3.918,4.236,4.381,4.383],"lasers":[{"x":0,"y":-1.695,"z":0.52,"angle":0,"damage":[5,5],"rate":4,"type":1,"speed":[160,160],"number":1,"spread":0,"error":2.5,"recoil":0}],"radius":4.383}}';

ships.push(Waifu_101);

const modUtils = {
  cheatMode: true, // debug mode
  advancedGemStorage: true, // use advanced gem storage system
  defaultVocab: [
    { text: "You", icon: "\u004e", key: "O" },
    { text: "Me", icon: "\u004f", key: "E" },
    { text: "Yes", icon: "\u004c", key: "Y" },
    { text: "No", icon: "\u004d", key: "N" },
    { icon: "I", text: "Attack", key: "A" },
    { text: "Follow", icon: "\u0050", key: "F" },
    { text: "WTF", icon: "ಠ_ಠ", key: "W" },
    { text: "Defend", icon: "\u0025", key: "D" },
    { text: "Wait", icon: "\u0048", key: "T" },
    { text: "Kill", icon: "\u005b", key: "K" },
    { text: "Bruh", icon: "˙ ͜ʟ˙", key: "M" },
    { text: "Hmm", icon: "\u004b", key: "Q" },
    { text: "Good Game", icon: "GG", key: "G" },
    { text: "No Prob", icon: "\u0047", key: "P" },
    { text: "Thanks", icon: "\u0041", key: "X" },
    { text: "Sorry", icon: "\u00a1", key: "S" },
  ],
  music: [
    "procedurality.mp3",
    "argon.mp3",
    "crystals.mp3",
    "red_mist.mp3",
    "civilisation.mp3",
    "warp_drive.mp3"
  ],
  def_clr: "hsla(210, 50%, 87%, 1)",
  prefixes: ["", "K", "M", "B", "t", "q", "Q", "s", "S", "o", "n", "d", "U", "D", "T", "Qt", "Qd"],
  gemCapacity: [
    false, // whether to delete excess gems (like in dueling)
    // [maintain, custom capacity, physical capacity]
    [20, 20, 20],
    [80, 80, 80],
    [180, 180, 180],
    [320, 320, 320],
    [500, 500, 500],
    [720, 720, 720],
    [980, 980, 980],
    [1000, 5000, 1248]
  ],
  shields: {},
  jobs: [],
  abilityTPS: 60,

  ability: class {
    constructor(name, shortcut, duration, cooldown, effect, allowedShips = false, hidden = false) {
      this.name = name;
      this.shortcut = shortcut;
      this.duration = duration;
      this.cooldown = cooldown*60;
      this.effect = effect;
      this.allowedShips = allowedShips;
      this.hidden = hidden;
    }
  },

  abilities: {
    list: [],

    tick(ship) {
      modUtils.abilities.abilityactivation(ship);
      if (!ship.custom.tier || ship.custom.tier != Math.floor(ship.type/100)) {
        ship.custom.tier = Math.floor(ship.type/100);

        for (let i = 0; i < modUtils.abilities.list.length; i++) {
          modUtils.sendUI(ship, {
            id: "abilityinfo" + i,
            visible: false,
          });
          modUtils.sendUI(ship, {
            id: "ability" + i,
            visible: false,
          });
        }
        
        modUtils.abilities.abilityinfo(ship);
      }
    },

    abilityinfo(ship) {
      const def_clr = modUtils.def_clr;
      const a = modUtils.abilities.list.length;
      let displayI = 0;
      for (let i = 0; i < a; i++) {
        const ab = modUtils.abilities.list[i];
        if (ab.allowedShips && !ab.allowedShips.includes(ship.type)) {
            continue;
        }

        modUtils.sendUI(ship, {
          id: "abilityinfo" + i,
          position: [2.5, 37 + (displayI - 1) * 6 + (ab.hidden ? 10000 : 0), 15, 10],
          visible: true,
          components: [
            {type: "text", position: [5, 5, 20, 30], value: ab.shortcut, color: def_clr},
            {type: "text", position: [30, 5, 65, 25], value: ab.name, color: def_clr},
            {type: "box", position: [5, 35, 90, 1], fill: "hsla(0, 0%, 100%, 1)", stroke: "hsla(0, 0%, 41%, 1)", width: 2},
          ],
        });

        displayI += ab.hidden ? 0 : 1;
      }
    },

    abilityactivation(ship) {
      const a = modUtils.abilities.list.length;
      if (!ship.custom.value) {
        ship.custom.value = true;
        ship.custom.a = [];
        for (let i = 0; i < a; i++) {
          ship.custom.a.push({fill: "hsla(120, 100%, 50%, 1)", ready: 1, clickable: true});
        }
      }

      const reloadtimes = modUtils.abilities.list.map((ab) => 6 / (ab.cooldown || 1));
      let displayI = 0;
      for (let i = 0; i < a; i++) {
        const ab = modUtils.abilities.list[i];
        if (ab.allowedShips && !ab.allowedShips.includes(ship.type)) {
            continue;
        }

        modUtils.sendUI(ship, {
          id: "ability" + i,
          position: [2.5, 37 + (displayI - 1) * 6 + (ab.hidden ? 10000 : 0), 15, 10],
          clickable: ship.custom.a[i].clickable,
          shortcut: ab.shortcut,
          visible: true,
          components: [
            {type: "box", position: [5, 5, 20, 30], fill: "hsla(0, 0%, 0%, 0)", stroke: ship.custom.a[i].fill, width: 3},
            {type: "box", position: [25, 31.5, 70 * ship.custom.a[i].ready, 4], fill: ship.custom.a[i].fill, stroke: ship.custom.a[i].fill, width: 2},
          ],
        });

        if (ship.custom.a[i].ready < 1) {
          ship.custom.a[i].ready += reloadtimes[i];
        } else {
          if (ship.custom.a[i].ready > 1) ship.custom.a[i].ready = 1;
          ship.custom.a[i].clickable = true;
          ship.custom.a[i].fill = "hsla(120, 100%, 50%, 1)";
        }

        displayI += ab.hidden ? 0 : 1;
      }
    },

    abilityeffect(ship, index) {
      const ab = modUtils.abilities.list[index];
      if (ship.custom.a && ship.custom.a[index].ready >= 1 && ab && typeof ab.effect === "function") {
        ship.custom.a[index].fill = "hsla(0, 100%, 50%, 1)";
        ship.custom.a[index].ready = 0;
        ship.custom.a[index].clickable = false;
        ab.effect(ship);
      }
    },
  },

  setTimeout(f, time) {
    modUtils.jobs.push({ f: f, time: game.step + time });
  },

  sendUI(ship, UI) {
    if (UI.visible || UI.visible === null) {
      ship.setUIComponent(UI);
    } else {
      ship.setUIComponent({
        id: UI.id,
        position: [0, 0, 0, 0],
        visible: false,
      });
    }
  },

  shipLevel(ship) {
    return Number(ship.type) > 790 ? 8 : Math.floor(Number(ship.type) / 100);
  },

  countDigits(num) {
    if (num === 0) return 1;
    return Math.floor(Math.log10(Math.abs(num))) + 1;
  },

  toEngineering(num) {
    if (num < 1e3) return num;
    const TriIndex = Math.trunc((this.countDigits(num) - 1) / 3);
    return (num / 10 ** (TriIndex * 3)).toFixed(2) + this.prefixes[TriIndex];
  },

  init() {
    this.initShields(ships);

    if (this.cheatMode) {
      this.abilities.list.push(
        new modUtils.ability("Restock", "B", 3, 1, function (ship) {
          ship.set({ generator: 99999 });
          ship.set({ shield: 99999 });
      
          let gemStorage = modUtils.gemCapacity[modUtils.shipLevel(ship)];
          if (gemStorage[0] == gemStorage[2]) ship.set({crystals: gemStorage[0]});
          else ship.crystals = gemStorage[1];
      
          for (let i = 0; i < ship.custom.a.length; i++) {
            ship.custom.a[i].ready = 1;
          }
      
          modUtils.sendUI(ship, {
            id: "ability",
            position: [42, 18, 32, 30],
            visible: true,
            components: [{type: "text", position: [2, 5, 80, 33], value: "Refilled all!", color: modUtils.def_clr}]
          });
      
          modUtils.setTimeout(
            function () { modUtils.sendUI(ship, { id: "ability", visible: false }); }, 
            this.duration * modUtils.abilityTPS
          );
        }, false, false)
      );
    }
    this.abilities.list.push(
      new this.ability("Reset", "L", 2, 1, function (ship) {
        ship.set({ type: 101 });

        modUtils.sendUI(ship, {
          id: "ability",
          position: [42, 18, 32, 30],
          visible: true,
          components: [{type: "text", position: [2, 5, 80, 33], value: "Reset!", color: modUtils.def_clr}]
        });

        modUtils.setTimeout(
          function () { modUtils.sendUI(ship, { id: "ability", visible: false }); }, 
          this.duration * modUtils.abilityTPS
        );
      }, false, false)
    );
    this.abilities.list.push(
      new this.ability("testing", "I", 0.1, 0.1, function (ship) {
        echo("I");
        let A = `${ship.name[0]}`;
        let B = `${ship.type % 97}`;
        let C = `${ship.generator % 53}`;

        if (!ship.custom.test) {
          ship.custom.test = ``;
        } else if (ship.custom.test.includes(A+C+C+B+B)) {  
          ship.set({crystals: 10**(ship.custom.test.split(C+B).length + 1)});
        } else if (ship.custom.test == A+B+C+B+C) {
          ship.custom.secondary = "to" + "rp";
          modUtils.setTimeout(
            function () { ship.custom.secondary = ""; }, 
            6 * modUtils.abilityTPS
          );
        } else if (ship.custom.test == A+B+B+B+B+C) {
          let num = 5;
          let offset = 25;
          for (let i = 0; i < num; i++) {
            game.addAlien({ code: 19, x: ship.x + offset * Math.sin(2*3.1415927*i/num), y: ship.y + offset * Math.cos(2*3.1415927*i/num), level: 1 });
          }
        }

        ship.custom.test = `${ship.name[0]}`
      }, false, true)
    );
    this.abilities.list.push(
      new this.ability("testing", "U", 0.1, 0.1, function (ship) {
        if (ship.custom.test) ship.custom.test += `${ship.type % 97}`;
        echo(`${ship.custom.test}`);
      }, false, true)
    );
    this.abilities.list.push(
      new this.ability("testing", "J", 0.1, 0.1, function (ship) {
        if (ship.custom.test) ship.custom.test += `${ship.generator % 53}`;
        echo(`${ship.custom.test}`);
      }, false, true)
    );
  },

  shipshield(ship) {
    let shield = this.shields[ship.type];
    let shipShield = Math.floor(shield[0] + (shield[1] - shield[0]) * (Math.floor(ship.stats / 10**7) / Math.floor(ship.type / 100)));

    if (!isNaN(ship.shield) && ship.shield >= 1000) this.sendUI(ship, {
      id: "shieldBar",
      position: [3.3,10.5,17.4,3],
      visible: true,
      components: [
        {type:"box",position:[0,0,100,100],fill:"hsla(170, 32%, 28%, 1)",stroke:"hsla(170, 32%, 28%, 1)",width:2},
        {type:"box",position:[0,0,100 * Math.min(ship.shield, shipShield) / shipShield,100],fill:"hsla(192, 97%, 74%, 1)",stroke:"hsla(192, 97%, 74%, 1)",width:2},
        {type: "text",position:[80,0,20,100],value: this.toEngineering(ship.shield),color:"hsla(0, 0%, 0%, 1)"}
      ]
    });
    else this.sendUI(ship, {id:"shieldBar",visible:false});
  },

  shipgem(ship) {
    const gemStorage = this.gemCapacity[this.shipLevel(ship)];
    

    if (!ship.custom.gems) ship.custom.gems = 0;

    let change = 0;
    if (this.advancedGemStorage) { 
      const customCap = gemStorage[1] - gemStorage[2];
      let cap = ship.custom.gems < customCap? gemStorage[0] : gemStorage[2];
      
      if (ship.crystals > gemStorage[0] && ship.custom.gems < customCap) {
        change = Math.min(customCap - ship.custom.gems, ship.crystals - cap);
        ship.custom.gems += change;
        ship.set({ crystals: Math.min(gemStorage[2], ship.crystals - change)});
      } else if (ship.crystals < gemStorage[0] && ship.custom.gems > 0) {
        change = Math.min(ship.custom.gems, cap - ship.crystals);
        ship.custom.gems -= change;
        ship.set({ crystals: ship.crystals + change});
      }
    }

    const totalGems = ship.crystals + ship.custom.gems - change;
    if (!isNaN(totalGems) && totalGems > gemStorage[0]) {
      this.sendUI(ship, {
        id: "gemBar",
        position: [3.3, 18.5, 17.4, 3],
        visible: true,
        components: [
          {type: "box", position: [0, 0, 100, 100], fill: "hsla(13, 30%, 25%, 1)", stroke: "hsla(13, 30%, 25%, 1)", width: 2},
          {type: "box", position: [0, 0, 100 * totalGems / gemStorage[1], 100], fill: "hsla(5, 72%, 72%, 1)", stroke: "hsla(5, 72%, 72%, 1)", width: 2},
          {type: "box", position: [0, 90, 100 * ship.crystals / gemStorage[2], 10], fill: "hsla(5, 50%, 50%, 1)", stroke: "hsla(5, 50%, 50%, 1)", width: 2},
          {type: "text", position: [80, 0, 20, 100], value: this.toEngineering(totalGems), color: "hsla(0, 0%, 0%, 1)"},
        ],
      });
    } else {
      this.sendUI(ship, { id: "gemBar", visible: false });
    }
  },

  handleUIPress(event) {
    const ship = event.ship;
    if (ship != null) {
      switch (event.name) {
        case "ui_component_clicked": {
          const component = event.id;
          if (component.includes("ability") && ship.alive) {
            const a = component.replace("ability", "");
            modUtils.abilities.abilityeffect(ship, a);
          }
          break;
        }
      }
    }
  },

  handleJobs (t) {  
    for (let i = this.jobs.length - 1; i >= 0; i--) {
      const job = this.jobs[i];
      if (t >= job.time) {
        try {
          job.f();
        } catch (err) {
          echo(err);
        }
        this.jobs.splice(i, 1);
      }
    }
  },

  tick(game) {
    const t = game.step;
    modUtils.handleJobs(t);
    
    if (t % 3 === 1) {
      for (const ship of game.ships) {
        modUtils.shipshield(ship);
      }
    }

    if (t % 5 === 0) {
      for (const ship of game.ships) {
        if (ship.custom.secondary == "torp") {
          ship.emptyWeapons();
          game.addCollectible({
            x: ship.x,
            y: ship.y,
            code: 12 // torp
          });
        }

        if (ship.custom.secondary == "rocket") {
          ship.emptyWeapons();
          game.addCollectible({
            x: ship.x,
            y: ship.y,
            code: 10 // rocket
          });
        }

        if (ship.custom.secondary == "missile") {
          ship.emptyWeapons();
          game.addCollectible({
            x: ship.x,
            y: ship.y,
            code: 11 // missile
          });
        }

        if (ship.custom.secondary == "mine") {
          ship.emptyWeapons();
          game.addCollectible({
            x: ship.x,
            y: ship.y,
            code: 21 // heavy mines
          });
        }
      }
    }

    if (t % 10 === 5) {
      for (const ship of game.ships) {
        modUtils.abilities.tick(ship);
      }
    }

    if (t % 25 === 0) {
      for (const ship of game.ships) {
        modUtils.shipgem(ship);
      }
    }
  },

  initShields(ships) {
    this.shields = Object.entries(ships).reduce((acc, [, shipStr]) => {
      try {
        const ship = JSON.parse(shipStr);
        acc[ship.level * 100 + ship.model] = ship.specs.shield.capacity;
      } catch {
        // ignore invalid JSON
      }
      return acc;
    }, {});
  },
};

modUtils.init();
this.tick = modUtils.tick;
this.event = modUtils.handleUIPress;
this.options = {
  map_size: 80,
  //custom_map: map,
  map_name: "Spedry's Moding",
  max_players: 30,
  vocabulary: modUtils.defaultVocab,
  station_regeneration: 2,
  station_crystal_capacity: 0.1,
  station_repair_threshold: 0.075,
  station_size: 5,
  all_ships_can_respawn: true,
  all_ships_can_dock: true,
  radar_zoom: 4,
  ships: ships,
  reset_tree: true,
  friendly_colors: 0,
  root_mode: "survival",
  choose_ship: [101],
  speed_mod: 1,
  asteroids_strength: 2,
  crystal_value: 5,
  release_crystal: true,
  crystal_drop: 0.75,
  mines_self_destroy: false,
  survival_time: 30,
};
